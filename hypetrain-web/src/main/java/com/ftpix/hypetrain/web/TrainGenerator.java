package com.ftpix.hypetrain.web;

public class TrainGenerator {

    private static final int PEOPLE_PER_CAR = 20, FRONT_CAR_WIDTH = 1280, CAR_WIDTH = 1280;

    public static String withCars(int cars) {
        StringBuilder sb = new StringBuilder();

        sb.append(getSvgHeader(cars));

        sb.append("<g transform=\"scale(-1,1) translate("+-getTrainWidth(cars)+", 0)\">");
        sb.append(getFrontCar());

        for (int i = 1; i <= cars; i++) {
            sb.append(getCar(i));
        }

        sb.append("</g>");
        sb.append(getSvgFooter());
        return sb.toString();
    }

    private static String getCar(int i) {
        int x = i * CAR_WIDTH;
        return "    <g transform=\"translate(" + x + ",1086) scale(0.100000,-0.100000)\"\n" +
                "       fill=\"#303f9f\" stroke=\"none\">\n" +
                "        <path d=\"M3920 10565 l0 -295 335 0 335 0 0 -800 0 -800 -1807 -2 -1808 -3 -3\n" +
                "-297 -2 -298 325 0 325 0 0 -2355 0 -2355 -415 0 -415 0 0 -175 0 -175 -395 0\n" +
                "-395 0 0 -85 0 -85 393 -2 392 -3 5 -307 5 -308 658 3 c361 1 657 1 657 0 0\n" +
                "-2 -15 -26 -34 -55 -224 -352 -281 -797 -151 -1194 156 -478 560 -839 1058\n" +
                "-946 136 -29 407 -31 540 -5 587 118 1035 579 1132 1165 21 125 16 395 -9 507\n" +
                "-36 160 -101 323 -181 451 -25 40 -45 73 -45 75 0 2 232 4 515 4 283 0 515 -2\n" +
                "515 -4 0 -2 -22 -40 -50 -85 -232 -385 -265 -867 -87 -1282 130 -303 379 -562\n" +
                "682 -709 125 -61 194 -85 338 -117 133 -30 394 -32 531 -5 293 59 523 182 737\n" +
                "396 210 210 328 429 391 725 30 145 30 389 -1 536 -38 180 -99 335 -184 468\n" +
                "-26 40 -47 73 -47 75 0 1 234 2 520 2 286 0 520 -1 520 -2 0 -1 -16 -25 -36\n" +
                "-55 -88 -132 -168 -336 -200 -510 -24 -129 -24 -371 0 -498 80 -416 331 -767\n" +
                "701 -979 224 -128 494 -191 760 -177 639 33 1173 496 1311 1136 26 120 26 420\n" +
                "0 540 -37 174 -105 340 -192 478 -19 29 -34 56 -34 60 0 4 380 6 845 4 l845\n" +
                "-2 0 570 0 570 -230 0 -230 0 0 640 0 640 60 0 60 0 0 50 0 50 -440 0 -440 0\n" +
                "0 -50 0 -50 65 0 65 0 0 -640 0 -640 -195 0 -195 0 0 2355 0 2355 325 0 325 0\n" +
                "0 300 0 300 -1807 0 -1808 0 0 797 0 798 338 3 337 2 0 295 0 295 -2555 0\n" +
                "-2555 0 0 -295z m8320 -6565 l0 -640 -215 0 -215 0 0 640 0 640 215 0 215 0 0\n" +
                "-640z\" />\n" +
                "    </g>";
    }

    public static String withPeople(int people) {
        return withCars(Math.max(1, people / PEOPLE_PER_CAR));
    }


    private static String getFrontCar() {
        return "    <g transform=\"translate(0.000000,1119.000000) scale(0.100000,-0.100000)\"\n" +
                "       fill=\"#303f9f\" stroke=\"none\">\n" +
                "        <path d=\"M5840 10710 l0 -480 255 0 255 0 0 -1450 0 -1450 -1860 0 -1860 0 0\n" +
                "549 0 549 53 30 c71 40 152 129 187 204 42 90 52 175 48 416 -3 187 -5 213\n" +
                "-21 229 -17 17 -61 18 -711 21 -690 2 -693 2 -719 -19 l-27 -20 0 -233 c0\n" +
                "-128 5 -258 10 -287 24 -131 126 -265 243 -322 l57 -28 0 -543 0 -544 -242 -5\n" +
                "c-275 -5 -314 -11 -463 -82 -212 -99 -352 -261 -404 -466 l-17 -69 -32 45\n" +
                "c-63 89 -135 114 -332 115 -117 0 -130 -9 -130 -98 -1 -64 -2 -68 -33 -87 -19\n" +
                "-12 -44 -44 -62 -79 l-30 -60 0 -241 0 -241 30 -60 c18 -35 43 -67 62 -79 29\n" +
                "-18 32 -25 33 -68 0 -87 1 -87 158 -87 178 0 203 7 275 81 l57 58 0 -1102 c0\n" +
                "-1010 3 -1169 25 -1238 6 -18 -3 -19 -299 -19 l-306 0 0 -595 0 -595 629 0\n" +
                "629 0 -45 -67 c-98 -146 -172 -325 -215 -514 -20 -89 -23 -131 -23 -299 0\n" +
                "-168 3 -210 23 -299 65 -289 197 -534 397 -736 502 -509 1280 -589 1877 -193\n" +
                "121 81 324 282 400 398 106 162 189 353 221 512 l13 63 545 3 544 2 12 -62\n" +
                "c47 -240 191 -511 376 -705 216 -226 479 -371 785 -435 88 -18 139 -22 287\n" +
                "-22 199 0 308 17 480 76 476 160 863 597 965 1086 l13 62 542 0 543 0 17 -77\n" +
                "c58 -260 196 -511 390 -708 501 -509 1280 -589 1877 -193 121 80 324 282 400\n" +
                "398 116 176 199 379 234 570 24 130 24 390 0 520 -33 184 -115 390 -215 543\n" +
                "l-51 77 380 0 380 0 0 595 c0 588 0 595 -20 595 -20 0 -20 7 -20 3340 l0 3340\n" +
                "195 0 195 0 0 480 0 480 -3480 0 -3480 0 0 -480z m5050 -2100 l0 -1030 -1657\n" +
                "2 -1658 3 -3 1028 -2 1027 1660 0 1660 0 0 -1030z m-5597 -6262 c-4 -7 -24\n" +
                "-38 -44 -68 -146 -220 -239 -536 -239 -814 l0 -51 -519 0 -518 0 -6 121 c-14\n" +
                "275 -96 532 -238 750 l-49 74 811 0 c646 0 809 -3 802 -12z m3970 -55 c-145\n" +
                "-217 -228 -472 -240 -738 l-6 -140 -521 2 -521 3 -7 132 c-7 152 -26 260 -69\n" +
                "390 -34 105 -107 256 -167 346 -23 35 -42 65 -42 68 0 2 364 4 809 4 l809 0\n" +
                "-45 -67z\"/>\n" +
                "    </g>";
    }

    private static int getTrainWidth(int cars) {
        return FRONT_CAR_WIDTH + cars * CAR_WIDTH;
    }

    private static String getSvgHeader(int cars) {
        int width = getTrainWidth(cars);


        return String.format("<?xml version=\"1.0\" standalone=\"no\"?>\n" +
                "<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 20010904//EN\"\n" +
                "        \"http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd\">\n" +
                "<svg version=\"1.0\" xmlns=\"http://www.w3.org/2000/svg\"\n" +
                "     width=\"%dpt\" height=\"1119.000000pt\" viewBox=\"0 0 %d 1119.000000\"\n" +
                "     preserveAspectRatio=\"xMidYMid meet\">", width, width);
    }


    private static String getSvgFooter() {
        return "</svg>";
    }
}
